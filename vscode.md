# VS Code を初めて使う人用の説明

## VS Code の位置づけ

VS Code では単一のファイルを開いて編集するテキストエディタの側面と、
フォルダを開いてワークスペースとしてプロジェクトを開発できる統合開発環境の側面がある。  
ワークスペースとして扱うとそのフォルダだけでの設定ができる
(A フォルダでは javascript+html なプロジェクトで適した拡張を入れる、
B フォルダでは C#を開発するため別の拡張を入れたり専用のデバッグ構成をする、等)

## ワークスペースを開く

フォルダを右クリック ＞ `Code` で開く

フォルダのショートカットに対しても効くのでデスクトップにショートカットを置いておくと便利

## 初期設定

- `The 'Remote - WSL' extension is...` がうるさい場合
  - <kbd>⚙</kbd>
  - <kbd>Don't show again</kbd>
  - <kbd>No</kbd>

## サイドバー

(横向きに回転した図)  
![alt](img/sidebar.png)  
左(上)から

- エクスプローラー：ファイル一覧
- 全ファイル検索
- ソース管理：SVN や Git の操作
- 実行：あんまり使わない
- 拡張機能：拡張機能を入れたり消したり
- SVN(拡張)：ファイルのコミット履歴と比較したり
- SQL Server(拡張)：ほとんど Management Studio

## ファイル操作

右クリックでだいたい直感的に操作可能  
または  
![alt](img/explorer-buttons.png)  
左から新規ファイル・新規フォルダ・更新・階層をたたむ

## エディタ操作

- コマンドパレット表示
  <kbd>F1</kbd>  
  <kbd>ESC</kbd>で閉じる
- エクスプローラーの(非)表示
  <kbd>Ctrl</kbd>+<kbd>B</kbd>  
  開きっぱなしで邪魔に感じたときに使う
- ターミナルの(非)表示
  <kbd>Ctrl</kbd>+<kbd>@</kbd>  
  開きっぱなしで邪魔に感じたときに使う
- デバッグ実行
  <kbd>F5</kbd>  
  初回で未構成の場合は自動で構成が作成される。開いた構成ファイルは閉じて良い  
  メインメソッドが実行される
- サジェスト
  <kbd>Ctrl</kbd>+<kbd>Space</kbd>
- リファクタリング(式の変数化やコードの関数化)
  <kbd>Ctrl</kbd>+<kbd>.</kbd>
- 検索/置換
  <kbd>Ctrl</kbd>+<kbd>F</kbd> / <kbd>Ctrl</kbd>+<kbd>H</kbd>
- 全ファイル検索/置換
  <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>F</kbd> / <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>H</kbd>
- マルチカーソル
  とても便利。この記事のアニメーションを見て良さそうだと思ったら試してください
  [VSCode のマルチカーソル練習帳 - Qiita](https://qiita.com/TomK/items/3b1f5be07d708d7bd6c5)

その他よくやる操作はググればショートカットかコマンドか拡張が出てくる(選択文字列を大文字化するとかキャメルケースにするとか)

## コマンドパレット操作

- <kbd>F1</kbd>でコマンドパレット表示
- `>コマンド`でコマンドを実行(>は勝手に入力されている)  
  コマンドの検索結果が下に表示されるので <kbd>↓</kbd>かクリックで選択  
  押された状況(ファイル種類など)で使えるコマンドも変わる。右クリックに近いイメージ
- `ファイル名`でファイル名検索したり開いたりできる
- `:行番号`で指定の行にジャンプできる  
  `ファイル名:行番号`も可能

## コマンド

よく使うであろうコマンド。  
律儀に全文を打たずに打ちやすい部分だけ入力しても出てくる。  
対応するショートカットキーがアレばコマンド検索結果の右の方に出てくるのでそれを使っても良い。  
エディタ内で右クリックでもできる操作もあるのでそちらでもよい。

### SQL Server (mssql)拡張

#### DB 接続

```
>MSSQL: Connect
```

sql ファイルを開いた状態で。  
事前に設定されたデータベースを選んで接続できる。
接続するとそのファイルの中でテーブル名やカラム名のサジェストを使用できる。

#### SQL 実行

```
>MSSQL: Execute Query
```

ファイル内のすべてまたは選択範囲の SQL を実行する。一文だけ実行するコマンドもある。

### C#拡張

#### テスト実行

```
>.NET: Run Tests in Context
>.NET: Debug Tests in Context
```

テスト関数がある .cs ファイル内で。  
カーソルがあるクラスまたは関数内の全てのテストを実行する。
デバッグの場合は Assert 失敗した部分で処理が止まる。(テスト関数内でエラーが起きないなら意味ない)  
全ファイルのテストを実行したいなら

```
>Tasks: Run Test Task
```

## 起動が遅いとき

拡張入れすぎ。  
重そうな拡張機能や一部のワークスペースでしか使わない拡張機能を一度無効にしてワークスペースでのみ有効にすると、少し軽くなる
